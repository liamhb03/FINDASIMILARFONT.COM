<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Fonts Clone</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="/scripts/tailwindcss.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <meta name="robots" content="index, follow">
    <meta name="keywords" content="keyword1, keyword2, keyword3">
    <meta name="description" content="A concise summary of your page with relevant keywords.">

    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;700&family=Lato:wght@400;700&family=Montserrat:wght@400;700&family=Playfair+Display:wght@400;700&family=Oswald:wght@400;700&family=Raleway:wght@400;700&family=Source+Sans+Pro:wght@400;700&display=swap" rel="stylesheet">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q96WK0V6EC"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-Q96WK0V6EC');
    </script>

    <style>
        .font-preview {
            transition: all 0.3s ease;
        }
        .font-preview:hover {
            background-color: #f3f4f6;
        }
        .slider {
            -webkit-appearance: none;
            height: 4px;
            background: #ddd;
            border-radius: 5px;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #4285f4;
            cursor: pointer;
        }
        .font-roboto { font-family: 'Roboto', sans-serif; }
        .font-open-sans { font-family: 'Open Sans', sans-serif; }
        .font-lato { font-family: 'Lato', sans-serif; }
        .font-montserrat { font-family: 'Montserrat', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .font-oswald { font-family: 'Oswald', sans-serif; }
        .font-raleway { font-family: 'Raleway', sans-serif; }
        .font-source { font-family: 'Source Sans Pro', sans-serif; }
        
        .sample-text {
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: 100%;
        }
        
        /* Mobile responsive styles */
        @media (max-width: 768px) {
            .sidebar-container {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 50;
                background-color: rgba(255, 255, 255, 0.95);
                overflow-y: auto;
            }
            
            .sidebar-container.active {
                display: block;
            }
            
            .sidebar-inner {
                width: 100%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center">
                <div class="flex items-center">
                    <img src="logo.png" alt="Google Fonts Logo" class="h-8">
                </div>
            </div>
            <div class="w-1/2 relative">
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span class="material-icons text-gray-400">search</span>
                    </div>
                    <input type="text" id="searchInput" class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-full bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Search fonts">
                </div>
            </div>
            <div class="flex items-center">
                <button id="cartButton" class="flex items-center justify-center bg-white p-2 rounded-full border border-gray-300">
                    <div id="likedCounter"U>
                        <span id="likeCount">0</span>
                    </div>
                    <span class="material-icons">favorite</span>
                </button>
                <button id="mobileMenuToggle" class="flex md:hidden items-center justify-center bg-white p-2 ml-2">
                    <span class="material-icons">menu</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6">
        <div class="flex flex-col md:flex-row">
            <!-- Left Sidebar - Hidden on mobile by default -->
            <div id="sidebar" class="sidebar-container md:block md:w-64 md:pr-6">
                <div class="sidebar-inner">
                    <button id="closeSidebar" class="md:hidden mb-4 flex items-center justify-center p-2">
                        <span class="material-icons">close</span>
                        <span class="ml-1">Close</span>
                    </button>
                    
                    <button id="filterButton" class="mb-6 bg-blue-600 text-white flex items-center py-2 px-4 rounded-full">
                        <span class="material-icons mr-1">close</span>
                        <span>Clear Filters</span>
                    </button>
                    
                    <!-- Image Upload Section -->
                    <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                        <h2 class="text-lg font-medium mb-4">Find similar fonts</h2>
                        <div class="bg-gray-100 rounded p-4 mb-4 flex flex-col items-center justify-center">
                            <span class="material-icons text-4xl text-gray-400 mb-2">upload_file</span>
                            <p class="text-gray-600 text-center mb-2">Upload an image to find similar fonts</p>
                            <label for="imageUpload" class="bg-blue-600 text-white py-2 px-4 rounded-full cursor-pointer">
                                Upload Image
                            </label>
                            <input type="file" id="imageUpload" class="hidden" accept="image/*">
                        </div>
                    </div>
                    
                    <!-- Preview Section -->
                    <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                        <h2 class="text-lg font-medium mb-4">Preview</h2>
                        <div class="bg-gray-100 rounded p-4 mb-4">
                            <p id="previewText" class="text-gray-600">Type something</p>
                        </div>
                        <div class="flex items-center">
                            <div id="fontSizeSelect" class="bg-gray-100 text-gray-700 rounded p-2 pr-8 mr-3">40px</div>
                            <input type="range" id="fontSizeSlider" min="8" max="96" value="40" class="slider flex-grow">
                        </div>
                    </div>

                    <!-- Filter Sections -->
                    <div class="mb-6">
                        <h2 class="text-lg font-medium mb-2">Filter</h2>
                        
                        <!-- Feeling Filter -->
                        <div class="bg-white rounded-lg shadow-sm mb-6">
                            <button class="w-full filter-toggle flex items-center justify-between p-4" data-target="feeling-filters">
                                <div class="flex items-center">
                                    <span class="material-icons mr-2">sentiment_satisfied_alt</span>
                                    <span>Feeling</span>
                                </div>
                                <span class="material-icons">expand_less</span>
                            </button>
                            <div id="feeling-filters" class="p-4 grid grid-cols-2 gap-2">
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="feeling" data-value="business">Business</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center italic cursor-pointer" data-category="feeling" data-value="fancy">Fancy</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="feeling" data-value="calm">Calm</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="feeling" data-value="playful">Playful</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center italic cursor-pointer" data-category="feeling" data-value="cute">Cute</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="feeling" data-value="artistic">Artistic</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="feeling" data-value="vintage">Vintage</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="feeling" data-value="loud">Loud</div>
                            </div>
                        </div>
                        
                        <!-- Appearance Filter -->
                        <div class="bg-white rounded-lg shadow-sm mb-6">
                            <button class="w-full filter-toggle flex items-center justify-between p-4" data-target="appearance-filters">
                                <div class="flex items-center">
                                    <span class="material-icons mr-2">visibility</span>
                                    <span>Appearance</span>
                                </div>
                                <span class="material-icons">expand_more</span>
                            </button>
                            <div id="appearance-filters" class="p-4 grid grid-cols-2 gap-2 hidden">
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="appearance" data-value="techno">Techno</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="appearance" data-value="monospaced">Monospaced</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="appearance" data-value="blobby">Blobby</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="appearance" data-value="marker">Marker</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="appearance" data-value="artdeco">Art Deco</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="appearance" data-value="artnouveau">Art Nouveau</div>
                            </div>
                        </div>
                        
                        <!-- Calligraphy Filter -->
                        <div class="bg-white rounded-lg shadow-sm mb-6">
                            <button class="w-full filter-toggle flex items-center justify-between p-4" data-target="calligraphy-filters">
                                <div class="flex items-center">
                                    <span class="material-icons mr-2">brush</span>
                                    <span>Calligraphy</span>
                                </div>
                                <span class="material-icons">expand_more</span>
                            </button>
                            <div id="calligraphy-filters" class="p-4 grid grid-cols-2 gap-2 hidden">
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="calligraphy" data-value="all">All</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center italic cursor-pointer" data-category="calligraphy" data-value="handwritten">Handwritten</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center italic cursor-pointer" data-category="calligraphy" data-value="formal">Formal</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="calligraphy" data-value="informal">Informal</div>
                            </div>
                        </div>
                        
                        <!-- Serif Filter -->
                        <div class="bg-white rounded-lg shadow-sm mb-6">
                            <button class="w-full filter-toggle flex items-center justify-between p-4" data-target="serif-filters">
                                <div class="flex items-center">
                                    <span class="material-icons mr-2">format_shapes</span>
                                    <span>Serif</span>
                                </div>
                                <span class="material-icons">expand_more</span>
                            </button>
                            <div id="serif-filters" class="p-4 grid grid-cols-2 gap-2 hidden">
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="serif" data-value="all">All</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="serif" data-value="transitional">Transitional</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="serif" data-value="slab">Slab</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="serif" data-value="oldstyle">Old Style</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="serif" data-value="modern">Modern</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="serif" data-value="humanist">Humanist</div>
                            </div>
                        </div>
                        
                        <!-- Sans Serif Filter -->
                        <div class="bg-white rounded-lg shadow-sm mb-6">
                            <button class="w-full filter-toggle flex items-center justify-between p-4" data-target="sans-serif-filters">
                                <div class="flex items-center">
                                    <span class="material-icons mr-2">text_fields</span>
                                    <span>Sans Serif</span>
                                </div>
                                <span class="material-icons">expand_more</span>
                            </button>
                            <div id="sans-serif-filters" class="p-4 grid grid-cols-2 gap-2 hidden">
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="sans-serif" data-value="all">All</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="sans-serif" data-value="humanist">Humanist</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="sans-serif" data-value="geometric">Geometric</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="sans-serif" data-value="neo-grotesque">Neo Grotesque</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="sans-serif" data-value="rounded">Rounded</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="sans-serif" data-value="superellipse">Superellipse</div>
                            </div>
                        </div>
                        
                        <!-- Seasonal Filter -->
                        <div class="bg-white rounded-lg shadow-sm mb-6">
                            <button class="w-full filter-toggle flex items-center justify-between p-4" data-target="seasonal-filters">
                                <div class="flex items-center">
                                    <span class="material-icons mr-2">event</span>
                                    <span>Seasonal</span>
                                </div>
                                <span class="material-icons">expand_more</span>
                            </button>
                            <div id="seasonal-filters" class="p-4 grid grid-cols-2 gap-2 hidden">
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="seasonal" data-value="lunar-new-year">Lunar New Year</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center italic cursor-pointer" data-category="seasonal" data-value="valentines">Valentine's</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="seasonal" data-value="holi">Holi</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="seasonal" data-value="halloween">HALLOWEEN</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="seasonal" data-value="diwali">Diwali</div>
                                <div class="filter-tag bg-gray-100 rounded p-2 text-center cursor-pointer" data-category="seasonal" data-value="christmas">Christmas</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="flex-1">
                <div class="mb-4 flex items-center justify-between">
                    <div class="text-sm text-gray-600"><span id="fontCount">0</span> of <span id="totalFonts">0</span> families</div>
                    <div class="flex md:hidden">
                        <button id="mobileFiltersBtn" class="bg-blue-600 text-white flex items-center py-2 px-4 rounded-full">
                            <span class="material-icons mr-1">filter_list</span>
                            <span>Filters</span>
                        </button>
                    </div>
                </div>

                <!-- Active Filters Display -->
                <div id="activeFilters" class="mb-4 flex flex-wrap gap-2">
                    <!-- Active filters will be displayed here -->
                </div>

                <!-- Font List -->
                <div id="fontList" class="space-y-6">
                    <!-- Fonts will be dynamically added here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 w-full max-w-lg mx-4">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-medium">Liked Fonts</h2>
                <button id="closeCart" class="text-gray-500 hover:text-gray-700">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div id="likedFontsList" class="max-h-96 overflow-y-auto mb-4">
                <!-- Liked fonts will be displayed here -->
            </div>
            <div class="flex justify-end">
                <button id="clearLikes" class="bg-red-600 text-white py-2 px-4 rounded mr-2">Clear All</button>
                <button id="closeCartBtn" class="bg-gray-200 text-gray-800 py-2 px-4 rounded">Close</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
    // DOM elements initialization
    const fontList = document.getElementById('fontList');
    const searchInput = document.getElementById('searchInput');
    const previewText = document.getElementById('previewText');
    const fontSizeSlider = document.getElementById('fontSizeSlider');
    const fontSizeSelect = document.getElementById('fontSizeSelect');
    const fontCount = document.getElementById('fontCount');
    const totalFonts = document.getElementById('totalFonts');
    const activeFilters = document.getElementById('activeFilters');
    const cartButton = document.getElementById('cartButton');
    const cartModal = document.getElementById('cartModal');
    const closeCart = document.getElementById('closeCart');
    const closeCartBtn = document.getElementById('closeCartBtn');
    const likedFontsList = document.getElementById('likedFontsList');
    const clearLikes = document.getElementById('clearLikes');
    const likedCounter = document.getElementById('likedCounter');
    const likeCount = document.getElementById('likeCount');
    const filterToggles = document.querySelectorAll('.filter-toggle');
    const filterTags = document.querySelectorAll('.filter-tag');
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileFiltersBtn = document.getElementById('mobileFiltersBtn');
    const sidebar = document.getElementById('sidebar');
    const closeSidebar = document.getElementById('closeSidebar');
    
    // Initialize filters and fonts arrays
    let activeFiltersList = [];
    let fonts = [];
    
    // Font styles container in head
    const fontStylesContainer = document.createElement('style');
    document.head.appendChild(fontStylesContainer);
    
    // Initialize liked fonts
    let likedFonts = getLikedFontsFromCookies();
    updateLikedCounter();

    // Load fonts from CSV file
    loadFontsFromCSV();
    
    // Function to load and parse CSV file
    function loadFontsFromCSV() {
        fetch('google_fonts.csv')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.text();
            })
            .then(csvText => {
                parseCSV(csvText);
                // Set total fonts count after loading
                totalFonts.textContent = fonts.length;
                // Load the actual font files
                loadGoogleFonts();
                // Render all fonts
                renderFonts(fonts);
            })
            .catch(error => {
                console.error('Error loading CSV file:', error);
                // Fallback to sample data if CSV fails to load
                loadSampleFonts();
            });
    }

    // Parse CSV data
    function parseCSV(csvText) {
        // Split by lines and remove any empty lines
        const lines = csvText.split('\n').filter(line => line.trim() !== '');
        
        // Skip header row
        for (let i = 1; i < lines.length; i++) {
            // Handle CSV parsing with consideration for commas within quotes
            const row = parseCSVLine(lines[i]);
            
            if (row.length >= 4) {
                const name = row[0].trim();
                const url = row[1].trim();
                const designer = row[2].trim();
                const variants = row[3].trim();
                
                // Determine font category based on name or apply default categorization
                const category = determineCategory(name);
                
                // Determine tags based on name and category
                const tags = determineTags(name, category);
                
                // Create font family CSS class name - ensure it's web-safe
                const cssFamily = formatFontNameForCSS(name);
                
                // Extract font family for Google Fonts API
                const fontFamily = extractFontFamilyFromURL(url);
                
                // Add to fonts array with sample text
                fonts.push({
                    name,
                    designer,
                    variants,
                    sample: 'Everyone has the right to freedom of thought, conscience and religion',
                    category,
                    cssFamily,
                    fontFamily,
                    tags,
                    url
                });
            }
        }
    }
    
    // Extract font family name from Google Fonts URL
    function extractFontFamilyFromURL(url) {
        try {
            // Extract font name from URL
            const urlParts = url.split('/specimen/');
            if (urlParts.length > 1) {
                // Replace '+' with spaces for font family name
                return urlParts[1].replace(/\+/g, ' ');
            }
            return null;
        } catch (e) {
            console.error('Error extracting font family from URL:', e);
            return null;
        }
    }
    
    // Format font name for CSS usage
    function formatFontNameForCSS(fontName) {
        return 'gf_' + fontName.replace(/\s+/g, '_').replace(/[^a-zA-Z0-9_]/g, '');
    }
    
    // Parse a CSV line handling quoted values with commas
    function parseCSVLine(line) {
        const result = [];
        let current = '';
        let inQuotes = false;
        
        for (let i = 0; i < line.length; i++) {
            const char = line[i];
            
            if (char === '"') {
                inQuotes = !inQuotes;
            } else if (char === ',' && !inQuotes) {
                result.push(current);
                current = '';
            } else {
                current += char;
            }
        }
        
        // Add the last field
        result.push(current);
        return result;
    }
    
    // Load Google Fonts
    function loadGoogleFonts() {
        let fontsToLoad = [];
        let fontStyles = '';
        
        fonts.forEach(font => {
            if (font.fontFamily) {
                // Add to list of fonts to load from Google
                fontsToLoad.push(font.fontFamily.replace(/\s+/g, '+'));
                
                // Create CSS class for this font
                fontStyles += `
                    .${font.cssFamily} {
                        font-family: "${font.fontFamily}", sans-serif;
                        font-weight: 400;
                        font-style: normal;
                        font-stretch: normal;
                        font-optical-sizing: auto;
                        line-height: initial;
                    }
                `;
            }
        });
        
        // Create Google Fonts API URL
        if (fontsToLoad.length > 0) {
            const googleFontsLink = document.createElement('link');
            googleFontsLink.rel = 'stylesheet';
            googleFontsLink.href = `https://fonts.googleapis.com/css2?family=${fontsToLoad.join('&family=')}&display=swap`;
            document.head.appendChild(googleFontsLink);
            
            // Add font styles
            fontStylesContainer.textContent = fontStyles;
        }
    }
    
    // Determine font category based on name
    function determineCategory(name) {
        name = name.toLowerCase();
        
        if (name.includes('serif') && !name.includes('sans')) {
            return 'Serif';
        } else if (name.includes('sans')) {
            return 'Sans Serif';
        } else if (name.includes('mono') || name.includes('code')) {
            return 'Monospace';
        } else if (name.includes('display') || name.includes('decorative') || 
                  name.includes('fancy') || name.includes('headline')) {
            return 'Display';
        } else if (name.includes('script') || name.includes('handwriting') || 
                  name.includes('cursive') || name.includes('brush')) {
            return 'Script';
        } else {
            // Default to Sans Serif for unknown types
            return 'Sans Serif';
        }
    }
    
    // Determine tags based on font name and category
    function determineTags(name, category) {
        const tags = [];
        name = name.toLowerCase();
        
        // Add category-based tags
        if (category === 'Sans Serif') {
            tags.push('modern');
            if (name.includes('grotesque') || name.includes('gothic')) {
                tags.push('neo-grotesque');
            }
            if (name.includes('geometric')) {
                tags.push('geometric');
            } else {
                tags.push('humanist');
            }
        } else if (category === 'Serif') {
            if (name.includes('slab')) {
                tags.push('slab');
            } else if (name.includes('old') || name.includes('garamond')) {
                tags.push('old-style');
            } else {
                tags.push('transitional');
            }
            
            if (name.includes('elegant') || name.includes('book')) {
                tags.push('elegant');
            }
        } else if (category === 'Display') {
            tags.push('artistic');
            if (name.includes('fun') || name.includes('comic') || name.includes('round')) {
                tags.push('playful');
            }
            if (name.includes('vintage') || name.includes('retro')) {
                tags.push('vintage');
            }
        } else if (category === 'Script') {
            tags.push('cursive');
            if (name.includes('elegant') || name.includes('calligraph')) {
                tags.push('elegant');
            }
            if (name.includes('brush') || name.includes('hand')) {
                tags.push('handwritten');
            }
        } else if (category === 'Monospace') {
            tags.push('coding');
            tags.push('technical');
        }
        
        // Add style-based tags
        if (name.includes('bold') || name.includes('black')) {
            tags.push('bold');
        }
        if (name.includes('light') || name.includes('thin')) {
            tags.push('light');
        }
        if (name.includes('condensed') || name.includes('compressed')) {
            tags.push('condensed');
        }
        if (name.includes('round') || name.includes('circular')) {
            tags.push('rounded');
        }
        
        // Add context tags
        if (name.includes('headline') || name.includes('display') || category === 'Display') {
            tags.push('headline');
        } else {
            tags.push('body');
        }
        
        // Add common usage tags
        if (category === 'Sans Serif' || category === 'Serif' || category === 'Monospace') {
            tags.push('business');
        }
        
        // Ensure we have some default tags if none were assigned
        if (tags.length === 0) {
            tags.push('modern', 'versatile');
        }
        
        return tags;
    }
    
    // Fallback to sample data if CSV fails to load
    function loadSampleFonts() {
        fonts = [
            {
                name: 'Roboto',
                designer: 'Christian Robertson, Paratype, Font Bureau',
                variants: 'Variable (3 axes)',
                sample: 'Everyone has the right to freedom of thought, conscience and religion',
                category: 'Sans Serif',
                cssFamily: 'gf_Roboto',
                fontFamily: 'Roboto',
                tags: ['business', 'calm', 'geometric', 'neo-grotesque'],
                url: 'https://fonts.google.com/specimen/Roboto'
            },
            {
                name: 'Noto Sans',
                designer: 'Google',
                variants: 'Variable (1 axis)',
                sample: 'Everyone has the right to freedom of thought, conscience and religion',
                category: 'Sans Serif',
                cssFamily: 'gf_Noto_Sans',
                fontFamily: 'Noto Sans',
                tags: ['business', 'modern', 'geometric', 'rounded'],
                url: 'https://fonts.google.com/specimen/Noto+Sans'
            },
            {
                name: 'Bungee Tint',
                designer: 'David Jonathan Ross',
                variants: '1 style',
                sample: 'EVERYONE HAS THE RIGHT TO FREEDOM OF THOUGHT',
                category: 'Display',
                cssFamily: 'gf_Bungee_Tint',
                fontFamily: 'Bungee Tint',
                tags: ['playful', 'loud', 'artistic', 'halloween'],
                url: 'https://fonts.google.com/specimen/Bungee+Tint'
            }
        ];
        
        // Set total fonts count
        totalFonts.textContent = fonts.length;
        
        // Load the Google Fonts
        loadGoogleFonts();
        
        // Render fonts
        renderFonts(fonts);
    }
    
    // Create font preview cards
    function renderFonts(fontsToRender) {
        fontList.innerHTML = '';
        fontCount.textContent = fontsToRender.length;
        
        fontsToRender.forEach(font => {
            const isLiked = likedFonts.includes(font.name);
            const fontCard = document.createElement('div');
            fontCard.className = 'font-preview bg-white border-t border-b py-6';
            
            fontCard.innerHTML = `
                <div class="flex items-center justify-between mb-2">
                    <div>
                        <span class="font-medium text-lg">${font.name}</span>
                        <span class="text-gray-500 ml-2">${font.variants}</span>
                        <span class="text-gray-500 mx-2">|</span>
                        <span class="text-gray-500">${font.designer}</span>
                    </div>
                    <div>
                        <button class="like-button text-${isLiked ? 'red' : 'blue'}-600 hover:bg-${isLiked ? 'red' : 'blue'}-50 p-1 rounded" data-font="${font.name}">
                            <span class="material-icons">${isLiked ? 'favorite' : 'favorite_border'}</span>
                        </button>
                        <a href="${font.url}" target="_blank" class="text-blue-600 hover:bg-blue-50 p-1 rounded ml-1">
                            <span class="material-icons">open_in_new</span>
                        </a>
                    </div>
                </div>
                <p class="text-4xl mt-2 sample-text ${font.cssFamily}" 
                   style="font-size: ${fontSizeSlider.value}px; text-align: start; transition-property: opacity, transform; 
                   font-family: '${font.fontFamily}', sans-serif; font-weight: 400; font-style: normal; 
                   font-stretch: normal; font-optical-sizing: auto; opacity: 1; line-height: initial; transition-duration: 350ms;">
                    ${previewText.textContent !== 'Type something' ? previewText.textContent : font.sample}
                </p>
                <div class="mt-2 flex flex-wrap gap-1">
                    ${font.tags.map(tag => `<span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">${tag}</span>`).join('')}
                </div>
            `;
            
            fontList.appendChild(fontCard);
        });
        
        // Add event listeners to like buttons
        document.querySelectorAll('.like-button').forEach(button => {
            button.addEventListener('click', function() {
                const fontName = this.getAttribute('data-font');
                toggleLike(fontName, this);
            });
        });
    }

    // Filter fonts based on active filters and search
    function filterFonts() {
        const searchTerm = searchInput.value.toLowerCase();
        
        let filteredFonts = fonts.filter(font => 
            (font.name.toLowerCase().includes(searchTerm) || 
            font.designer.toLowerCase().includes(searchTerm) ||
            font.category.toLowerCase().includes(searchTerm) ||
            font.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
        );
        
        // Apply tag filters if any are active
        if (activeFiltersList.length > 0) {
            filteredFonts = filteredFonts.filter(font => {
                // Group filters by category
                const filtersByCategory = {};
                activeFiltersList.forEach(filter => {
                    if (!filtersByCategory[filter.category]) {
                        filtersByCategory[filter.category] = [];
                    }
                    filtersByCategory[filter.category].push(filter.value);
                });
                
                // For each category, check if the font matches ANY of the filters in that category
                for (const category in filtersByCategory) {
                    const categoryMatches = filtersByCategory[category].some(value => {
                        if (value === 'all') return true;
                        return font.tags.includes(value);
                    });
                    
                    // If the font doesn't match any filter in this category, exclude it
                    if (!categoryMatches) return false;
                }
                
                // If we get here, the font matches at least one filter in each category
                return true;
            });
        }
        
        renderFonts(filteredFonts);
    }

    // Search functionality
    searchInput.addEventListener('input', filterFonts);

    // Preview text input functionality
    previewText.addEventListener('click', function() {
        if (this.textContent === 'Type something') {
            this.textContent = '';
        }
        this.setAttribute('contenteditable', 'true');
        this.focus();
    });

    previewText.addEventListener('blur', function() {
        if (this.textContent.trim() === '') {
            this.textContent = 'Type something';
        }
    });

    previewText.addEventListener('input', function() {
        const sampleTexts = document.querySelectorAll('.sample-text');
        sampleTexts.forEach(sample => {
            if (this.textContent && this.textContent !== 'Type something') {
                sample.textContent = this.textContent;
            }
        });
    });

    // Font size slider functionality
    fontSizeSlider.addEventListener('input', function() {
        const size = this.value;
        fontSizeSelect.textContent = `${size}px`;
        const sampleTexts = document.querySelectorAll('.sample-text');
        sampleTexts.forEach(sample => {
            sample.style.fontSize = `${size}px`;
        });
    });

    // Filter toggle functionality
    filterToggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const targetElement = document.getElementById(targetId);
            const icon = this.querySelector('.material-icons');
            
            if (targetElement.classList.contains('hidden')) {
                targetElement.classList.remove('hidden');
                icon.textContent = 'expand_less';
            } else {
                targetElement.classList.add('hidden');
                icon.textContent = 'expand_more';
            }
        });
    });

    // Filter tag functionality
    filterTags.forEach(tag => {
        tag.addEventListener('click', function() {
            const category = this.getAttribute('data-category');
            const value = this.getAttribute('data-value');
            
            // Check if this filter is already active
            const existingFilterIndex = activeFiltersList.findIndex(
                filter => filter.category === category && filter.value === value
            );
            
            if (existingFilterIndex === -1) {
                // Add filter
                this.classList.remove('bg-gray-100');
                this.classList.add('bg-blue-100', 'border', 'border-blue-400');
                
                activeFiltersList.push({ category, value });
            } else {
                // Remove filter
                this.classList.remove('bg-blue-100', 'border', 'border-blue-400');
                this.classList.add('bg-gray-100');
                
                activeFiltersList.splice(existingFilterIndex, 1);
            }
            
            // Update active filters display
            updateActiveFiltersDisplay();
            
            // Filter fonts
            filterFonts();
        });
    });

    // Update active filters display
    function updateActiveFiltersDisplay() {
        activeFilters.innerHTML = '';
        
        if (activeFiltersList.length > 0) {
            activeFiltersList.forEach(filter => {
                const filterTag = document.createElement('div');
                filterTag.className = 'bg-blue-100 text-blue-800 border border-blue-400 rounded px-3 py-1 flex items-center';
                filterTag.innerHTML = `
                    <span>${filter.category}: ${filter.value}</span>
                    <button class="remove-filter ml-2 text-blue-600" data-category="${filter.category}" data-value="${filter.value}">
                        <span class="material-icons text-sm">close</span>
                    </button>
                `;
                activeFilters.appendChild(filterTag);
            });
            
            // Add clear all button
            const clearAllButton = document.createElement('div');
            clearAllButton.className = 'bg-gray-100 text-gray-800 rounded px-3 py-1 flex items-center cursor-pointer';
            clearAllButton.innerHTML = `
                <span>Clear all</span>
            `;
            clearAllButton.addEventListener('click', clearAllFilters);
            activeFilters.appendChild(clearAllButton);
        }
        
        // Add event listeners to remove filter buttons
        document.querySelectorAll('.remove-filter').forEach(button => {
            button.addEventListener('click', function() {
                const category = this.getAttribute('data-category');
                const value = this.getAttribute('data-value');
                
                // Remove from active filters list
                const filterIndex = activeFiltersList.findIndex(
                    filter => filter.category === category && filter.value === value
                );
                
                if (filterIndex !== -1) {
                    activeFiltersList.splice(filterIndex, 1);
                }
                
                // Update the UI state of the corresponding filter tag
                const filterTag = document.querySelector(`.filter-tag[data-category="${category}"][data-value="${value}"]`);
                if (filterTag) {
                    filterTag.classList.remove('bg-blue-100', 'border', 'border-blue-400');
                    filterTag.classList.add('bg-gray-100');
                }
                
                // Update active filters display
                updateActiveFiltersDisplay();
                
                // Filter fonts
                filterFonts();
            });
        });
    }

    // Clear all filters
    function clearAllFilters() {
        // Reset all filter tags
        document.querySelectorAll('.filter-tag').forEach(tag => {
            tag.classList.remove('bg-blue-100', 'border', 'border-blue-400');
            tag.classList.add('bg-gray-100');
        });
        
        // Clear active filters list
        activeFiltersList = [];
        
        // Update active filters display
        updateActiveFiltersDisplay();
        
        // Reset font list
        filterFonts();
    }

    // Like/unlike functionality
    function toggleLike(fontName, button) {
        const index = likedFonts.indexOf(fontName);
        
        if (index === -1) {
            // Add to liked fonts
            likedFonts.push(fontName);
            button.innerHTML = '<span class="material-icons">favorite</span>';
            button.classList.remove('text-blue-600', 'hover:bg-blue-50');
            button.classList.add('text-red-600', 'hover:bg-red-50');
        } else {
            // Remove from liked fonts
            likedFonts.splice(index, 1);
            button.innerHTML = '<span class="material-icons">favorite_border</span>';
            button.classList.remove('text-red-600', 'hover:bg-red-50');
            button.classList.add('text-blue-600', 'hover:bg-blue-50');
        }
        
        // Save to cookies
        saveLikedFontsToCookies();
        
        // Update like counter
        updateLikedCounter();
    }

    // Save liked fonts to cookies
    function saveLikedFontsToCookies() {
        document.cookie = `likedFonts=${JSON.stringify(likedFonts)}; path=/; max-age=31536000`; // 1 year
    }

    // Get liked fonts from cookies
    function getLikedFontsFromCookies() {
        const cookieMatch = document.cookie.match(/likedFonts=([^;]+)/);
        if (cookieMatch) {
            try {
                return JSON.parse(cookieMatch[1]);
            } catch (e) {
                return [];
            }
        }
        return [];
    }

    // Update liked counter
    function updateLikedCounter() {
        likeCount.textContent = likedFonts.length;
        
        if (likedFonts.length > 0) {
            likedCounter.classList.remove('hidden');
            likedCounter.classList.add('flex');
        } else {
            likedCounter.classList.remove('flex');
            likedCounter.classList.add('hidden');
        }
    }

    // Cart functionality
    cartButton.addEventListener('click', openCart);
    closeCart.addEventListener('click', closeCartModal);
    closeCartBtn.addEventListener('click', closeCartModal);

    function openCart() {
        updateLikedFontsList();
        cartModal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function closeCartModal() {
        cartModal.classList.add('hidden');
        document.body.style.overflow = '';
    }

    function updateLikedFontsList() {
        likedFontsList.innerHTML = '';
        
        if (likedFonts.length === 0) {
            likedFontsList.innerHTML = '<p class="text-center text-gray-500 py-4">No liked fonts yet.</p>';
            return;
        }
        
        likedFonts.forEach(fontName => {
            const font = fonts.find(f => f.name === fontName);
            if (!font) return;
            
            const fontItem = document.createElement('div');
            fontItem.className = 'flex items-center justify-between border-b py-3';
            
            fontItem.innerHTML = `
                <div>
                    <span class="font-medium">${font.name}</span>
                    <span class="text-gray-500 ml-2">${font.variants}</span>
                </div>
                <div class="flex">
                    <a href="${font.url}" target="_blank" class="text-blue-600 hover:bg-blue-50 p-1 rounded mr-2">
                        <span class="material-icons text-sm">open_in_new</span>
                    </a>
                    <button class="unlike-button text-red-600 hover:bg-red-50 p-1 rounded" data-font="${font.name}">
                        <span class="material-icons">favorite</span>
                    </button>
                </div>
            `;
            
            likedFontsList.appendChild(fontItem);
        });
        
        // Add event listeners to unlike buttons
        document.querySelectorAll('.unlike-button').forEach(button => {
            button.addEventListener('click', function() {
                const fontName = this.getAttribute('data-font');
                
                // Remove from liked fonts
                const index = likedFonts.indexOf(fontName);
                if (index !== -1) {
                    likedFonts.splice(index, 1);
                }
                
                // Save to cookies
                saveLikedFontsToCookies();
                
                // Update liked counter
                updateLikedCounter();
                
                // Update liked fonts list
                updateLikedFontsList();
                
                // Update main font list
                const likeButton = document.querySelector(`.like-button[data-font="${fontName}"]`);
                if (likeButton) {
                    likeButton.innerHTML = '<span class="material-icons">favorite_border</span>';
                    likeButton.classList.remove('text-red-600', 'hover:bg-red-50');
                    likeButton.classList.add('text-blue-600', 'hover:bg-blue-50');
                }
            });
        });
    }

    // Clear all likes
    clearLikes.addEventListener('click', function() {
        likedFonts = [];
        saveLikedFontsToCookies();
        updateLikedCounter();
        updateLikedFontsList();
        
        // Update main font list
        document.querySelectorAll('.like-button').forEach(button => {
            button.innerHTML = '<span class="material-icons">favorite_border</span>';
            button.classList.remove('text-red-600', 'hover:bg-red-50');
            button.classList.add('text-blue-600', 'hover:bg-blue-50');
        });
    });

    // Image upload functionality
    const imageUpload = document.getElementById('imageUpload');
    
    imageUpload.addEventListener('change', function(e) {
        if (e.target.files && e.target.files[0]) {
            const reader = new FileReader();
            
            reader.onload = function(event) {
                // Here you would normally send the image to a backend service
                // to analyze and find similar fonts
                
                // For demo purposes, just show a success message
                alert('Image uploaded! (Functionality to find similar fonts would be implemented on a backend service)');
            };
            
            reader.readAsDataURL(e.target.files[0]);
        }
    });

    // Mobile menu functionality
    mobileMenuToggle.addEventListener('click', function() {
        sidebar.classList.add('active');
    });
    
    mobileFiltersBtn.addEventListener('click', function() {
        sidebar.classList.add('active');
    });
    
    closeSidebar.addEventListener('click', function() {
        sidebar.classList.remove('active');
    });

    // Close modal when clicking outside
    cartModal.addEventListener('click', function(e) {
        if (e.target === cartModal) {
            closeCartModal();
        }
    });

    // Close on escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeCartModal();
            sidebar.classList.remove('active');
        }
    });
});
    </script>
</body>
</html>